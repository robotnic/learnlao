"use strict";(self.webpackChunklearnlao=self.webpackChunklearnlao||[]).push([[850],{1850:(z,C,c)=>{c.r(C),c.d(C,{LearnComponent:()=>N});var l=c(467),_=c(177),k=c(1626),F=c(9772),w=c(4843),t=c(4438),g=c(6885),s=c(1531);let y=(()=>{class n{constructor(){this.f=(0,g.$F)()}seedData(e){return(0,l.A)(function*(){if(0===(yield s.db.vocab.count())){const r=[...e].sort((a,b)=>a.usage_rank-b.usage_rank);yield s.db.vocab.bulkAdd(r);const i=r.map(a=>({...(0,g.O_)(new Date),id:a.id}));yield s.db.progress.bulkAdd(i)}})()}getNextQuestion(){var e=this;return(0,l.A)(function*(){const o=new Date,r=yield s.db.progress.where("due").below(o).and(u=>u.state!==g.Uw.New).toArray();let i=null;if(r.length>0&&(r.sort((u,m)=>{const f=u.due instanceof Date?u.due:new Date(u.due),p=m.due instanceof Date?m.due:new Date(m.due);return f.getTime()-p.getTime()}),i=r[0]),!i){const u=yield s.db.progress.where("state").equals(g.Uw.New).toArray();if(u.length>0){const m=u.map(p=>p.id),f=yield s.db.vocab.where("id").anyOf(m).toArray();if(f.length>0){f.sort((h,Q)=>h.usage_rank-Q.usage_rank);const p=f[0];i=u.find(h=>h.id===p.id)||null}}}if(!i)return null;const a=yield s.db.vocab.get(i.id);if(!a)return null;const v=[...yield e.getDistractors(a.english),a.english].sort(()=>.5-Math.random()),$=Math.random()>.5?"male":"female";return{word:a,choices:v,audioUrl:`assets/audio/${a.id}_${$}.mp3`}})()}processResult(e,o){var r=this;return(0,l.A)(function*(){const i=yield s.db.progress.get(e);if(!i)return;const a=o?g.GW.Good:g.GW.Again,v=r.f.repeat(i,new Date)[a].card;yield s.db.progress.put({...v,id:e})})()}getDistractors(e){return(0,l.A)(function*(){return(yield s.db.vocab.where("english").notEqual(e).limit(50).toArray()).sort(()=>.5-Math.random()).slice(0,3).map(r=>r.english)})()}getReviewCountToday(){return(0,l.A)(function*(){const e=new Date;return yield s.db.progress.where("due").below(e).and(r=>r.state!==g.Uw.New).count()})()}getNewWordsCount(){return(0,l.A)(function*(){return yield s.db.progress.where("state").equals(g.Uw.New).count()})()}static{this.\u0275fac=function(o){return new(o||n)}}static{this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var x=c(8658);function S(n,d){1&n&&(t.j41(0,"div",7),t.EFF(1," Loading next word... "),t.k0s())}function G(n,d){if(1&n){const e=t.RV6();t.j41(0,"button",20),t.bIt("click",function(){const r=t.eBV(e).$implicit,i=t.XpG(3);return t.Njj(i.selectAnswer(r))}),t.EFF(1),t.k0s()}if(2&n){const e=d.$implicit;t.R7$(),t.SpI(" ",e," ")}}function M(n,d){if(1&n&&(t.j41(0,"div",18),t.DNE(1,G,2,1,"button",19),t.k0s()),2&n){const e=t.XpG(2);t.R7$(),t.Y8G("ngForOf",e.gameState.currentQuestion.choices)}}function O(n,d){1&n&&(t.j41(0,"span"),t.EFF(1,"\u2713 Correct!"),t.k0s())}function P(n,d){1&n&&(t.j41(0,"span"),t.EFF(1,"\u2717 Wrong!"),t.k0s())}function j(n,d){if(1&n){const e=t.RV6();t.j41(0,"div",26)(1,"p"),t.EFF(2,"How difficult was it?"),t.k0s(),t.j41(3,"button",27),t.bIt("click",function(){t.eBV(e);const r=t.XpG(3);return t.Njj(r.submitRating(1))}),t.EFF(4,"Again"),t.k0s(),t.j41(5,"button",27),t.bIt("click",function(){t.eBV(e);const r=t.XpG(3);return t.Njj(r.submitRating(2))}),t.EFF(6,"Hard"),t.k0s(),t.j41(7,"button",27),t.bIt("click",function(){t.eBV(e);const r=t.XpG(3);return t.Njj(r.submitRating(3))}),t.EFF(8,"Good"),t.k0s(),t.j41(9,"button",27),t.bIt("click",function(){t.eBV(e);const r=t.XpG(3);return t.Njj(r.submitRating(4))}),t.EFF(10,"Easy"),t.k0s()()}}function R(n,d){if(1&n){const e=t.RV6();t.j41(0,"div",28)(1,"p"),t.EFF(2,'Auto-rated as "Hard" - Next review in 4 days'),t.k0s(),t.j41(3,"button",29),t.bIt("click",function(){t.eBV(e);const r=t.XpG(3);return t.Njj(r.nextQuestion())}),t.EFF(4,"Continue"),t.k0s()()}}function A(n,d){if(1&n&&(t.j41(0,"div",21)(1,"div",22),t.DNE(2,O,2,0,"span",17)(3,P,2,0,"span",17),t.j41(4,"div",23),t.EFF(5),t.k0s()(),t.DNE(6,j,11,0,"div",24)(7,R,5,0,"div",25),t.k0s()),2&n){const e=t.XpG(2);t.Y8G("ngClass",e.gameState.isCorrect?"correct":"incorrect"),t.R7$(2),t.Y8G("ngIf",e.gameState.isCorrect),t.R7$(),t.Y8G("ngIf",!e.gameState.isCorrect),t.R7$(2),t.JRh(e.gameState.currentQuestion.word.english),t.R7$(),t.Y8G("ngIf",e.gameState.isCorrect),t.R7$(),t.Y8G("ngIf",!e.gameState.isCorrect)}}function E(n,d){if(1&n&&(t.j41(0,"p"),t.EFF(1),t.k0s()),2&n){const e=t.XpG(2);t.R7$(),t.SpI("Accuracy: ",e.stats.accuracy,"%")}}function I(n,d){if(1&n){const e=t.RV6();t.j41(0,"div",8)(1,"div",9)(2,"div",10),t.EFF(3),t.k0s()(),t.j41(4,"div",11)(5,"button",12),t.bIt("click",function(){t.eBV(e);const r=t.XpG();return t.Njj(r.playAudio())}),t.EFF(6," \u{1f50a} Play Sound "),t.k0s()(),t.j41(7,"div",13)(8,"p"),t.EFF(9,"What does this word mean?"),t.k0s()(),t.DNE(10,M,2,1,"div",14)(11,A,8,6,"div",15),t.j41(12,"div",16)(13,"p"),t.EFF(14),t.k0s(),t.DNE(15,E,2,1,"p",17),t.k0s()()}if(2&n){const e=t.XpG();t.R7$(3),t.JRh(e.gameState.currentQuestion.word.lao),t.R7$(2),t.Y8G("disabled",e.gameState.isLoading),t.R7$(5),t.Y8G("ngIf",!e.gameState.isAnswered),t.R7$(),t.Y8G("ngIf",e.gameState.isAnswered),t.R7$(3),t.Lme("Progress: ",e.stats.correctCount,"/",e.stats.totalReviewed," correct"),t.R7$(),t.Y8G("ngIf",e.stats.totalReviewed>0)}}function T(n,d){1&n&&(t.j41(0,"div",30)(1,"p"),t.EFF(2,"No words to review right now!"),t.k0s(),t.j41(3,"p"),t.EFF(4,"Come back later for more words to review."),t.k0s(),t.j41(5,"a",31),t.EFF(6,"Back to Home"),t.k0s()())}let D=(()=>{class n{constructor(e,o){this.learningService=e,this.kbService=o,this.gameState={currentQuestion:null,isAnswered:!1,isCorrect:null,selectedAnswer:null,isLoading:!0},this.stats={totalReviewed:0,correctCount:0,accuracy:0},this.audioElement=null}ngOnInit(){var e=this;return(0,l.A)(function*(){try{e.gameState.isLoading=!0;const o=yield(0,w._)(e.kbService.getKnowledgeBase());if(o&&o.vocabulary&&o.vocabulary.length>0){const r=o.vocabulary.map((i,a)=>({...i,usage_rank:a}));yield e.learningService.seedData(r)}yield e.loadNextQuestion()}catch(o){console.error("Failed to initialize game:",o),e.gameState.isLoading=!1}})()}loadNextQuestion(){var e=this;return(0,l.A)(function*(){e.gameState.isLoading=!0;try{e.gameState.currentQuestion=yield e.learningService.getNextQuestion(),e.gameState.isAnswered=!1,e.gameState.isCorrect=null,e.gameState.selectedAnswer=null,e.gameState.currentQuestion&&e.playAudio()}catch(o){console.error("Failed to load next question:",o)}finally{e.gameState.isLoading=!1}})()}playAudio(){this.gameState.currentQuestion&&(this.audioElement&&this.audioElement.pause(),this.audioElement=new Audio(this.gameState.currentQuestion.audioUrl),this.audioElement.play().catch(e=>{console.error("Audio playback error:",e)}))}selectAnswer(e){this.gameState.isAnswered||(this.gameState.selectedAnswer=e,this.gameState.isCorrect=e===this.gameState.currentQuestion?.word.english,this.gameState.isAnswered=!0,this.stats.totalReviewed++,this.gameState.isCorrect&&this.stats.correctCount++,this.stats.accuracy=Math.round(this.stats.correctCount/this.stats.totalReviewed*100),this.gameState.isCorrect||setTimeout(()=>this.submitRating(1),3e3))}submitRating(e){var o=this;return(0,l.A)(function*(){o.gameState.currentQuestion&&(yield o.learningService.processResult(o.gameState.currentQuestion.word.id,o.gameState.isCorrect||!1),yield o.nextQuestion())})()}nextQuestion(){var e=this;return(0,l.A)(function*(){yield e.loadNextQuestion()})()}static{this.\u0275fac=function(o){return new(o||n)(t.rXU(y),t.rXU(x.r))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-fsrs-game"]],standalone:!0,features:[t.aNF],decls:11,vars:3,consts:[[1,"page"],[1,"container"],[1,"header"],["routerLink","/",1,"back-link"],["class","loading",4,"ngIf"],["class","game-container",4,"ngIf"],["class","no-words",4,"ngIf"],[1,"loading"],[1,"game-container"],[1,"word-display"],[1,"lao-word"],[1,"audio-section"],[1,"play-button",3,"click","disabled"],[1,"question"],["class","choices",4,"ngIf"],["class","feedback",3,"ngClass",4,"ngIf"],[1,"stats"],[4,"ngIf"],[1,"choices"],["class","choice-button",3,"click",4,"ngFor","ngForOf"],[1,"choice-button",3,"click"],[1,"feedback",3,"ngClass"],[1,"feedback-text"],[1,"translation"],["class","rating-buttons",4,"ngIf"],["class","continue",4,"ngIf"],[1,"rating-buttons"],[1,"rating-btn",3,"click"],[1,"continue"],[1,"continue-btn",3,"click"],[1,"no-words"],["routerLink","/",1,"back-button"]],template:function(o,r){1&o&&(t.j41(0,"div",0)(1,"div",1)(2,"header",2)(3,"a",3),t.EFF(4,"\u2190 Back"),t.k0s(),t.j41(5,"h1"),t.EFF(6,"Vocabulary Drill (FSRS)"),t.k0s()(),t.j41(7,"main"),t.DNE(8,S,2,0,"div",4)(9,I,16,7,"div",5)(10,T,7,0,"div",6),t.k0s()()()),2&o&&(t.R7$(8),t.Y8G("ngIf",r.gameState.isLoading),t.R7$(),t.Y8G("ngIf",!r.gameState.isLoading&&r.gameState.currentQuestion),t.R7$(),t.Y8G("ngIf",!r.gameState.isLoading&&!r.gameState.currentQuestion))},dependencies:[_.MD,_.YU,_.Sq,_.bT,k.q1,F.Wk],styles:[".page[_ngcontent-%COMP%]{min-height:100vh;background:#fff;padding:2rem}.container[_ngcontent-%COMP%]{max-width:600px;margin:0 auto}.header[_ngcontent-%COMP%]{margin-bottom:2rem}.back-link[_ngcontent-%COMP%]{display:inline-block;margin-bottom:1rem;color:#666;text-decoration:none;font-size:.9rem}.back-link[_ngcontent-%COMP%]:hover{color:#000}h1[_ngcontent-%COMP%]{font-size:2rem;font-weight:300;margin:0}.loading[_ngcontent-%COMP%]{text-align:center;padding:2rem;font-size:1.1rem;color:#666}.game-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.word-display[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:1rem;padding:2rem;background:#f9f9f9;border-radius:8px}.emoji[_ngcontent-%COMP%]{font-size:3rem}.lao-word[_ngcontent-%COMP%]{font-size:2rem;font-weight:400;color:#333}.audio-section[_ngcontent-%COMP%]{text-align:center}.play-button[_ngcontent-%COMP%]{padding:1rem 2rem;font-size:1.1rem;background:#007bff;color:#fff;border:none;border-radius:4px;cursor:pointer;transition:all .2s ease}.play-button[_ngcontent-%COMP%]:hover:not(:disabled){background:#0056b3}.play-button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.question[_ngcontent-%COMP%]{text-align:center;font-size:1.1rem;color:#666}.choices[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem}.choice-button[_ngcontent-%COMP%]{padding:1rem;font-size:.95rem;background:#fff;border:2px solid #e5e5e5;border-radius:4px;cursor:pointer;transition:all .2s ease}.choice-button[_ngcontent-%COMP%]:hover{border-color:#333;background:#f9f9f9}.choice-button[_ngcontent-%COMP%]:active{transform:scale(.98)}.feedback[_ngcontent-%COMP%]{padding:2rem;border-radius:8px;text-align:center}.feedback.correct[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.feedback.incorrect[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24}.feedback-text[_ngcontent-%COMP%]{font-size:1.3rem;font-weight:500;margin-bottom:1rem}.translation[_ngcontent-%COMP%]{font-size:1.1rem;margin-top:.5rem}.rating-buttons[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:.5rem;margin-top:1rem}.rating-buttons[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{grid-column:1 / -1;margin:0 0 .5rem;font-size:.95rem}.rating-btn[_ngcontent-%COMP%]{padding:.75rem;background:#fff;border:2px solid currentColor;border-radius:4px;cursor:pointer;font-size:.9rem;font-weight:500;transition:all .2s ease}.rating-btn[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.continue[_ngcontent-%COMP%]{margin-top:1rem}.continue[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.9rem;margin:0 0 1rem}.continue-btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background:#28a745;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:.95rem;transition:all .2s ease}.continue-btn[_ngcontent-%COMP%]:hover{background:#218838}.stats[_ngcontent-%COMP%]{text-align:center;font-size:.9rem;color:#666;padding:1rem;background:#f9f9f9;border-radius:4px}.stats[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.5rem 0}.no-words[_ngcontent-%COMP%]{text-align:center;padding:3rem 1rem}.no-words[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.1rem;color:#666;margin:1rem 0}.back-button[_ngcontent-%COMP%]{display:inline-block;margin-top:1rem;padding:.75rem 1.5rem;background:#007bff;color:#fff;text-decoration:none;border-radius:4px;transition:all .2s ease}.back-button[_ngcontent-%COMP%]:hover{background:#0056b3}"]})}}return n})(),N=(()=>{class n{static{this.\u0275fac=function(o){return new(o||n)}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-learn"]],standalone:!0,features:[t.aNF],decls:1,vars:0,template:function(o,r){1&o&&t.nrm(0,"app-fsrs-game")},dependencies:[D],encapsulation:2})}}return n})()}}]);